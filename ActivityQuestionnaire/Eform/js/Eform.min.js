$(function(){let o=[0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","Y","Z"],n="";function e(){for(var e=0;e<4;e++){var t=Math.floor(35*Math.random());n+=o[t]}$(".Contact_vericodePic").val(n)}function c(e){e=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}$(document).on("click",".Contact_Remake",function(){n="",e()}),$(document).on("click",".form_uls",function(){$(this).children("ul").slideToggle()}),$(document).on("click",".form_uls ul li",function(){$(this).parent().siblings().html($(this).text()),$(this).parent().siblings("input").val($(this).children().val())}),$(document).on("click",".form_category h3",function(){$(this).siblings().slideToggle()}),$(document).on("keyup",".form-confirm",function(){$(this).val($(this).val().trim())}),$(document).on("click","#submit",function(){let o=!0,n=!0,c=!1;var e=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/.test($("#contact-email").val()),t=/^[0-9]*$/.test($("#contact-mobile").val());let i=$("#contact_person").val()||"",a=$("#contact-email").val()||"",l=$("#contact-mobile").val()||"",r=$("#contact-company").val()||"",u=$("#contact-dept").val()||"",d=$('input[name="job-1"]:checked').siblings().text().trim()||"",m="",s,f=[{acp:[],hubspot:[]}],h=$("#contact-query").val()||"",p="",v,w=[{acp:[],hubspot:[]}],g="",x,b=[{acp:[],hubspot:[]}],k,y,_,C,E,S,I;$(".catecheckbox").each(function(e,t){$(t).is(":checked")&&(c=!0,w[0].hubspot.push($(t).val()),w[0].acp.push($(t).siblings().text().trim()),p=w[0].acp.join(";"),v=w[0].hubspot.join(";"))}),$(".othercheckbox").each(function(e,t){$(t).is(":checked")&&(f[0].hubspot.push($(t).val()),f[0].acp.push($(t).siblings().text().trim()),m=f[0].acp.join(";"),s=f[0].hubspot.join(";"))}),$(".functioncheckbox").each(function(e,t){$(t).is(":checked")&&(b[0].hubspot.push($(t).val()),b[0].acp.push($(t).siblings().text().trim()),g=b[0].acp.join(";"),x=b[0].hubspot.join(";"))}),$(".form-confirm").each(function(e,t){""===$(t).val()&&(o=!1)}),$(".form_ultitle").each(function(e,t){""!==$(t).html()&&"請選擇"!==$(t).html()||(n=!1)}),$("#reserve1").is(":checked")&&(o&&n&&c?e&&t?$("#contact-vercode").val()===$(".Contact_vericodePic").val()?(k=function(){var e=/WB\d{6}/.exec(location.pathname);return 0==document.querySelector("#fromSource").innerText?e[0]:document.querySelector("#fromSource").innerText}(),y=decodeURI(window.location.href).replace(/"/g,"'"),decodeURI(window.location.pathname),decodeURI($("#SourLoadLink").attr("href")),_=document.title,C=$("#telephone").val()||"",E=$("#extension").val()||"",S=$("#address").val()||"",I=$("#gclid_field").val()||"",r,i,a,l,u,d,g,p,h,m,$.support.cors=!0,alert("已送出")):window.wxc.xcConfirm("請輸入正確的驗證碼。</br>Please input correct verification code",window.wxc.xcConfirm.typeEnum.info):window.wxc.xcConfirm("Email格式錯誤或聯絡電話格式錯誤，請重新確認。</br>There are still contact information not filled in or the email format is wrong, please reconfirm.",window.wxc.xcConfirm.typeEnum.info):window.wxc.xcConfirm("尚有聯絡資料未填寫，請重新確認。</br>There are still contact information not filled in or the email format is wrong, please reconfirm.",window.wxc.xcConfirm.typeEnum.info))}),e(),window.addEventListener("load",function(){$(".eform_form .content").append('<input type="hidden" id="gclid_field" name="gclid_field" value="">');var t,e=c("gclid"),o=null,n=!(n=c("gclsrc"))||-1!==n.indexOf("aw");["gclid_field","foobar"].forEach(function(e){document.getElementById(e)&&(t=document.getElementById(e))}),e&&n&&(o={value:e,expiryDate:(new Date).getTime()+7776e6},localStorage.setItem("gclid",JSON.stringify(o)));e=(n=o||JSON.parse(localStorage.getItem("gclid")))&&(new Date).getTime()<n.expiryDate;t&&e&&(t.value=n.value)})});